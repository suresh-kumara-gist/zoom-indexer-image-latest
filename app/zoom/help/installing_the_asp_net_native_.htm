<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0014)about:internet -->
<head>
   <title>Installing the ASP.NET native control</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?installing_the_asp_net_native_.htm"; }
  else { parent.quicksync('a3.2'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#336699">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Installing the ASP.NET native server control</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="introduction.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="files_required.htm"><img src="prev.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="client_side_search_engine.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-style: italic;">Note that this procedure is not necessary for the PHP, Classic ASP or CGI versions.</span></p>
<p>If you are using the ASP.NET native control for your server-side search, there is a different installation procedure required. You will need to install the ASP.NET control directly on the server itself.</p>
<div style="text-align: left; text-indent: 0px; border-color: #808080; border-style: solid; border-width: 1px; border-right: none; border-left: none; padding: 0px 0px 0px 0px; margin: 14px 48px 10px 48px;"><table cellspacing="0" cellpadding="2" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="37" style="width:37px;"><p><img src="lightbulb.gif" width="32" height="32" border="0" alt="lightbulb" style="float:left;margin:0px;"></p>
</td>
<td valign="top" width="731" style="width:731px;"><p style="margin: 0px 0px 0px 0px;"><span class="f_Tip" style="font-weight: bold;">Note:</span><span class="f_Tip"> You will need the .NET Framework (version 2.0 or higher) and ASP.NET (version 2.0 or higher) installed on your server. The latest versions are available for download from the Microsoft website. </span></p>
</td>
</tr>
</table>
</div>
<p>First, you will need to download the MSI installation package from our website here:<br>
<a href="http://www.wrensoft.com/zoom/aspdotnet.html" target="_blank" class="weblink">http://www.wrensoft.com/zoom/aspdotnet.html</a></p>
<p>You will need to run and install this package on the server where you will be hosting the ASP.NET search from.</p>
<p>When you launch the MSI installer, you will be prompted for a path to install the control to. You should specify the folder which you wish to host the search page from.</p>
<p>Once you have done this, you will need to open up the IIS Manager and locate the folder in your "Web Sites" list. You will need to configure IIS to allow this folder to execute as an application. This can vary with different versions of IIS.</p>
<p>In IIS 7, you will need to right click and select <span style="font-style: italic;">"Convert to Application"</span>. Accept the default properties and click OK.</p>
<p><img src="embim1.png" width="339" height="275" vspace="1" hspace="1" border="0" alt=""></p>
<p>In IIS 5 and IIS 6, right click on the folder and select <span style="font-style: italic;">"Properties"</span>. Next, click the "Create" button and select the default options by clicking "OK".</p>
<p><img src="embim2.png" width="476" height="451" vspace="1" hspace="1" border="0" alt=""></p>
<div style="text-align: left; text-indent: 0px; border-color: #808080; border-style: solid; border-width: 1px; border-right: none; border-left: none; padding: 0px 0px 0px 0px; margin: 14px 48px 10px 48px;"><table cellspacing="0" cellpadding="2" border="0" style="border: none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="37" style="width:37px;"><p><img src="lightbulb.gif" width="32" height="32" border="0" alt="lightbulb" style="float:left;margin:0px;"></p>
</td>
<td valign="top" width="731" style="width:731px;"><p style="margin: 0px 0px 0px 0px;"><span class="f_Tip" style="font-weight: bold;">Note:</span><span class="f_Tip"> If you have multiple versions of ASP.NET installed, you may need to specify the version you wish to use for this application. You can do this from the "Properties" windows, under the "ASP.NET" tab where a drop-down box should be available for you to select the ASP.NET version to use. Please specify a version that is 2.0 or later. If you do not have the required version installed, you will need to download and install this from the Microsoft website.</span></p>
</td>
</tr>
</table>
</div>
<p>At this point, you should be able to load the "search.aspx" page on your website (for example, if you have installed the control in a folder named "zoomaspx" at the root level of your website, it would be accessible from a URL such as "http://www.mywebsite.com/zoomaspx/search.aspx" in your browser). You should get a response that looks something like this:</p>
<p style="line-height: 1.15; margin: 0px 0px 13px 24px;"><span class="f_CourierFixed">Content-type: text/html Unable to open settings.zdat or file is invalid.</span><br>
<span class="f_CourierFixed">Check file permissions and that file exists</span></p>
<p>This is normal and indicates that the ASP.NET control is working, and it just needs the index files to continue. </p>
<p>If you have not already done so, you will now need to index your website as described in Chapter 2, "<a href="zoom_search_engine_indexer.htm">Indexing your website</a>". This will create a set of index files and a search template which you can upload or copy over to the same folder where you have the ASP.NET control installed. </p>
<p>Once the index files (all ZDAT files and the "search_template.html" page) are hosted in the same folder, you should find that your search page will now be fully operational and you can customize the appearance of your search page as described in, "<a href="how_do_i_customize_the_look.htm">How do I customize the look of my search page?</a>".</p>
<p class="p_Heading2"><span class="f_Heading2">Troubleshooting</span></p>
<p>There are currently known issues with displaying non-English characters in the search results using the ASP.NET native control. </p>
<p>Some .NET web page generation tools will put a HTML &lt;form&gt; that surrounds the entirety of the document. By default this form submits using POST, whereas this control uses GET variables. It is recommended to move this control outside of the form, but if that is not possible (i.e. the form is on the master page) then try placing the following lines of code within the ASPX code behind load function:</p>
<p><span style="font-style: italic;">C#</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_CodeExample">this.Form.Method = "GET";</span><br>
<span class="f_CodeExample">this.Form.EnableViewState = false;</span><br>
<span class="f_CodeExample">this.ClientScript.RegisterClientScriptBlock(GetType(), "clr", @"document.getElementById('__VIEWSTATE').value = '';", true);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p><span style="font-style: italic;">Visual Basic</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">Form.Method&nbsp;=&nbsp;"GET"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">Form.EnableViewState&nbsp;=&nbsp;False</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample">Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "clr", "document.getElementById('__VIEWSTATE').value = ''", True)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>

</td></tr></table>

</body>
</html>
